# ============================================================================
# ESSENTIAL RULES - Apply to ALL systems
# ============================================================================
# This section contains representative examples of high-volume, low-risk SIDs
# that consistently generate false positives across typical network environments.
# These rules detect legitimate protocol anomalies, benign application behavior,
# and standard system operations that do not indicate security threats.
# 
# Note: This is not an exhaustive list. Additional noisy SIDs may exist depending
# on your specific network topology, application stack, and user behavior patterns.
# Regular log analysis is recommended to identify environment-specific noise.
#
# SYNTAX:
#   #2031071  # Commented SID = Rule remains ACTIVE (generates alerts)
#   2031071   # Uncommented SID = Rule is DISABLED (suppressed via disable.conf)
# ============================================================================

# --- SURICATA Internal Anomalies (High noise, low security value) ---
2221000  # HTTP unknown error
2221001  # HTTP gzip decompression failed
2221002  # HTTP request field missing colon
2221003  # HTTP invalid request chunk len
2221004  # HTTP invalid response chunk len
2221005  # HTTP invalid transfer encoding value in request
2221006  # HTTP invalid transfer encoding value in response
2221007  # HTTP invalid content length field in request
2221008  # HTTP invalid content length field in response
2221009  # HTTP status 100-Continue already seen
2221010  # HTTP unable to match response to request
2221011  # HTTP invalid server port in request
2221012  # HTTP invalid authority port
2221013  # HTTP request header invalid
2221014  # HTTP missing Host header
2221015  # HTTP Host header ambiguous
2260001  # Applayer Wrong direction first Data
#2210054  # STREAM excessive retransmissions
#2210050  # STREAM reassembly overlap with different data
#2210007  # STREAM 3way handshake SYNACK with wrong ack

# --- System Updates & Package Managers ---
2100366  # Windows Update User-Agent

# --- Operating System Connectivity Checks ---
2031071  # Microsoft Connection Test (Windows)
2023184  # Windows NCSI (Network Connectivity Status)
2036220  # Android Connectivity Check
2024678  # Apple Captive Portal Detection

# --- DNS over HTTPS (DoH) ---
2047866  # Google DNS over HTTPS (dns.google)
2046071  # Google DNS over HTTPS (dns.google.com)

# --- WebRTC / Video Conferencing ---
2016149  # STUN Binding Request
2016150  # STUN Binding Response

# --- Common User-Agents ---
2060251  # Go-http-client (Legitimate Go applications)


# ============================================================================
# ENVIRONMENT-SPECIFIC RULES
# Uncomment only if these services are legitimately used in YOUR environment
# ============================================================================

# --- Cloud Storage & Sync ---
#2019401  # Google Drive Sync
#2024364  # Dropbox Client
#2034764  # OneDrive Sync

# --- Cloud Platforms ---
#2063117  # azurewebsites.net (Azure web apps)
#2034856  # amazonaws.com (AWS services)

# --- SMB/NMBD (Network File Sharing) ---
#2225006  # SMB file overlap
#2025709  # SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement (SECURITY - Consider keeping)

# --- Printing (IPP, SMB, SNMP, Web) ---
# Common in office environments with network printers
#2056212  # IPP Get-Printer-Attributes Outbound Request
#2102348  # GPL NETBIOS SMB-DS DCERPC print spool bind attempt
#2102349  # GPL NETBIOS SMB-DS DCERPC enumerate printers request attempt
#2100971  # GPL WEB_SERVER ISAPI .printer access
#2015959  # ET SNMP Samsung Printer SNMP Hardcode RW Community String
#2010919  # ET WEB_SERVER HP LaserJet Printer Cross Site Scripting Attempt
#2102547  # GPL MISC HP Web JetAdmin remote file upload attempt

# --- Remote Desktop / Remote Access ---
#2043343  # RustDesk Domain
#2044076  # RustDesk Relay Domain
#2027765  # TeamViewer
#2027761  # AnyDesk TLS Certificate
#2027762  # AnyDesk User-Agent
#2060507  # AnyDesk Relay Domain (net.anydesk.com in DNS)
#2060512  # Anydesk Domain (boot .net .anydesk .com) in DNS Lookup

# --- Media Streaming ---
#2027398  # Spotify
#2034858  # Netflix

# --- Linux ---
#2025627  # Kali Linux APT Updates
#2013505  # YUM package manager (RedHat/CentOS/Fedora)

# --- Peer-to-Peer / Non-Standard Ports ---
#2033078  # STUN non-standard port (May indicate tunneling - keep active unless P2P apps used)

# --- Development & CI/CD ---
#2034923  # GitHub API
#2035124  # Docker Hub
#2036455  # npm Registry

# --- Telemetry & Analytics ---
#2013031  # Google Analytics
#2018959  # Microsoft Telemetry
#2034567  # Firefox Telemetry

# --- VPN / Proxy Detection ---
#2024789  # OpenVPN
#2025634  # WireGuard
#2026891  # Tor Exit Nodes


# ============================================================================
# CUSTOM RULES - Add your own below
# ============================================================================

# Example:
# 2999999  # Custom internal application


# ============================================================================
# NOTES:
# - Global rules are disabled by default across all systems
# - Environment-specific rules are COMMENTED - only enable if you use the service
# - Test after making changes: sudo systemctl reload suricata
# - Check active rules: grep -c '^alert' /var/lib/suricata/rules/suricata.rules
# ============================================================================
